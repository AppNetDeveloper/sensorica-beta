# ============================================
# CONFIGURACIÓN PUERTO SERIE
# ============================================
SERIAL_PORT=/dev/ttyUSB0
BAUD_RATE=115200
DATA_BITS=8
STOP_BITS=1
PARITY=none

# ============================================
# MODBUS (DESACTIVADO - USAMOS RS232 ASCII)
# ============================================
MODBUS_ENABLED=false
MODBUS_SLAVE_ID=2
MODBUS_WEIGHT_INPUT_START=9
MODBUS_WEIGHT_INPUT_COUNT=2

# ============================================
# CONFIGURACIÓN MQTT
# ============================================
MQTT_BROKER_URL=mqtt://localhost
MQTT_TOPIC_BASE=sensorica/bascula/peso
MQTT_TOPIC_DOSIFICA=sensorica/bascula/dosifica
MQTT_TOPIC_ZERO=sensorica/bascula/zero
MQTT_TOPIC_TARA=sensorica/bascula/tara

# ============================================
# CONFIGURACIÓN RS232 ASCII
# ============================================

# Comando para pedir peso
RS232_COMMAND=A

# Terminadores del comando
RS232_APPEND_CR=true
RS232_APPEND_LF=true

# Intervalo de sondeo (milisegundos)
POLL_INTERVAL_MS=300

# ============================================
# CONFIGURACIÓN GLOBAL (VALORES POR DEFECTO)
# ============================================

# Factor de escala (divisor)
RS232_SCALE=0.00001

# Offset (calibración a 0)
RS232_OFFSET=760695

# Tara (peso de contenedor en kg)
RS232_TARA=0.52

# Decimales en publicación MQTT
RS232_DECIMALS=2

# Umbral de cero (convierte valores pequeños a 0)
RS232_ZERO_THRESHOLD=0.01

# No publicar si el valor no cambió
RS232_PUBLISH_UNCHANGED=false

# ============================================
# AUTO-CALIBRACIÓN Y AUTO-CORRECCIÓN
# ============================================

# Auto-calibración al arrancar
RS232_AUTO_OFFSET=true
RS232_MIN_OFFSET=100000

# Auto-corrección continua (DESACTIVADA)
RS232_AUTO_CORRECT_ENABLED=false
RS232_AUTO_CORRECT_THRESHOLD=50
RS232_LOW_WEIGHT_SAMPLES=100
RS232_MAX_OFFSET_CHANGE=50000

# Guardar offset en .env
RS232_PERSIST_OFFSET=true

# ============================================
# AUTO-TARA INTELIGENTE (SISTEMA DE 3 RANGOS)
# ============================================

RS232_AUTO_TARA_ENABLED=true

# RANGO 1: [0 - 0.05 kg] → Ajusta OFFSET
RS232_AUTO_OFFSET_MAX=0.05

# RANGO 2: [0.05 - 0.4 kg] → Establece TARA
RS232_AUTO_TARA_MIN=0.05
RS232_AUTO_TARA_MAX=0.4

# Tiempo de estabilidad (segundos)
RS232_AUTO_TARA_TIME=30

# ============================================
# CONFIGURACIÓN DE DIRECCIONES MÚLTIPLES
# ============================================

# Direcciones a monitorizar (separadas por comas)
RS232_ADDRESSES=1

# Prefijo del comando de dirección (opcional)
RS232_ADDRESS_PREFIX=

# ============================================
# CONFIGURACIÓN ESPECÍFICA POR DIRECCIÓN
# ============================================

# Dirección 1:
RS232_OFFSET_1=760695
RS232_TARA_1=0.52
RS232_SCALE_1=0.00001